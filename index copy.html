<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Happy Valentine‚Äôs üíò</title>
  <style>
    :root{
      /* --bg1:#ff4d6d; */
      --bg1:#dbdbdb;
      --bg2:#7b2cbf;
      --card: rgba(255,255,255,0.14);
      --card2: rgba(255,255,255,0.10);
      --text:#fff;
      --shadow: 0 20px 60px rgba(0,0,0,0.25);
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      color: var(--text);
      min-height: 100vh;
      background: radial-gradient(circle at 20% 10%, #ffccd5 0%, transparent 30%),
                  radial-gradient(circle at 80% 20%, #ffd6ff 0%, transparent 30%),
                  linear-gradient(135deg, var(--bg1), var(--bg2));
      overflow-x:hidden;
    }

    /* Floating hearts background */
    .hearts{
      position: fixed;
      inset: 0;
      pointer-events:none;
      overflow:hidden;
      z-index:0;
    }
    .heart{
      position:absolute;
      width: 18px;
      height: 18px;
      transform: rotate(45deg);
      opacity: .8;
      animation: floatUp linear forwards;
      filter: drop-shadow(0 8px 10px rgba(0,0,0,.2));
    }
    .heart:before, .heart:after{
      content:"";
      position:absolute;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: inherit;
    }
    .heart:before{ left:-9px; top:0; }
    .heart:after{ left:0; top:-9px; }

    @keyframes floatUp{
      from{ transform: translateY(30vh) rotate(45deg) scale(.9); }
      to{ transform: translateY(-120vh) rotate(45deg) scale(1.3); }
    }

    /* Layout */
    .wrap{
      position:relative;
      z-index:1;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 24px;
    }
    .card{
      width:min(980px, 100%);
      background: linear-gradient(180deg, var(--card), var(--card2));
      backdrop-filter: blur(14px);
      border: 1px solid rgba(255,255,255,0.18);
      border-radius: 26px;
      box-shadow: var(--shadow);
      overflow:hidden;
    }

    header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding: 18px 18px 0 18px;
      gap: 12px;
    }
    .dots{
      display:flex;
      gap:8px;
      align-items:center;
    }
    .dot{
      width:10px;height:10px;border-radius:50%;
      background: rgba(255,255,255,.35);
    }
    .dot.active{ background: rgba(255,255,255,.9); }

    .nav{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:flex-end;
    }
    .pill{
      border: 1px solid rgba(255,255,255,.25);
      background: rgba(255,255,255,.12);
      color:#fff;
      padding:10px 14px;
      border-radius: 999px;
      cursor:pointer;
      user-select:none;
      transition: transform .12s ease, background .12s ease, opacity .12s ease;
      font-weight: 600;
      font-size: 14px;
    }
    .pill:hover{ transform: translateY(-1px); background: rgba(255,255,255,.18); }
    .pill:active{ transform: translateY(0px); }
    .pill[disabled]{
      opacity:.45;
      cursor:not-allowed;
      transform:none;
    }
    .pill[disabled]:hover{ transform:none; background: rgba(255,255,255,.12); }

    .status-badge{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 10px 12px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.22);
      background: rgba(0,0,0,.12);
      font-weight: 800;
      font-size: 13px;
      letter-spacing: .01em;
      white-space:nowrap;
    }
    .status-dot{
      width:8px;
      height:8px;
      border-radius:50%;
      background: rgba(255,255,255,.55);
    }
    .status-dot.ok{ background: rgba(255,255,255,.92); }

    main{
      padding: 18px;
    }

    .page{
      display:none;
      animation: pop .35s ease both;
    }
    .page.active{ display:block; }
    @keyframes pop{
      from{ opacity:0; transform: translateY(10px) scale(.98); }
      to{ opacity:1; transform: translateY(0) scale(1); }
    }

    /* Intro */
    .hero{
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap: 18px;
      align-items:center;
    }
    @media (max-width: 780px){
      .hero{ grid-template-columns: 1fr; }
    }
    h1{
      margin: 6px 0 8px;
      font-size: clamp(28px, 4vw, 44px);
      letter-spacing: -0.02em;
    }
    .subtitle{
      margin:0;
      opacity:.95;
      font-size: clamp(14px, 2.2vw, 18px);
      line-height:1.5;
    }
    .type{
      margin-top: 14px;
      padding: 14px 14px;
      border-radius: 18px;
      background: rgba(0,0,0,0.14);
      border: 1px solid rgba(255,255,255,0.15);
      font-size: 16px;
      min-height: 58px;
      white-space: pre-wrap;
    }
    .big-emoji{
      display:flex;
      align-items:center;
      justify-content:center;
      border-radius: 22px;
      border: 1px solid rgba(255,255,255,0.18);
      background: rgba(255,255,255,0.10);
      min-height: 220px;
      position:relative;
      overflow:hidden;
    }
    .big-emoji span{
      font-size: 86px;
      filter: drop-shadow(0 18px 18px rgba(0,0,0,.25));
      animation: bob 1.8s ease-in-out infinite;
    }
    @keyframes bob{
      0%,100%{ transform: translateY(0); }
      50%{ transform: translateY(-10px); }
    }

    .cta-row{
      display:flex;
      gap:12px;
      margin-top: 14px;
      flex-wrap:wrap;
      align-items:center;
    }
    .btn{
      border: none;
      cursor:pointer;
      padding: 12px 16px;
      border-radius: 16px;
      font-weight: 800;
      color: #2b0a3d;
      background: #fff;
      transition: transform .12s ease, box-shadow .12s ease, opacity .12s ease;
      box-shadow: 0 10px 30px rgba(0,0,0,.22);
    }
    .btn:hover{ transform: translateY(-1px); }
    .btn:active{ transform: translateY(0); }
    .btn.secondary{
      color:#fff;
      background: rgba(255,255,255,.12);
      border: 1px solid rgba(255,255,255,.25);
      box-shadow:none;
    }
    .btn[disabled]{
      opacity:.55;
      cursor:not-allowed;
      transform:none;
    }

    /* Gallery */
    .gallery-head{
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      gap: 12px;
      flex-wrap:wrap;
      margin-bottom: 12px;
    }
    .gallery-grid{
      display:grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 12px;
    }
    @media (max-width: 920px){ .gallery-grid{ grid-template-columns: repeat(3, 1fr); } }
    @media (max-width: 650px){ .gallery-grid{ grid-template-columns: repeat(2, 1fr); } }

    .tile{
      position:relative;
      border-radius: 18px;
      overflow:hidden;
      cursor:pointer;
      border: 1px solid rgba(255,255,255,.18);
      background: rgba(0,0,0,0.18);
      aspect-ratio: 1 / 1;
      transition: transform .12s ease;
    }
    .tile:hover{ transform: translateY(-2px) scale(1.01); }
    .tile img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
      filter: saturate(1.1);
      transform: scale(1.02);
    }
    .tile:after{
      content:"‚ú®";
      position:absolute;
      right:10px; top:10px;
      opacity:0;
      transform: translateY(-6px);
      transition: opacity .15s ease, transform .15s ease;
      text-shadow: 0 10px 18px rgba(0,0,0,.35);
    }
    .tile:hover:after{
      opacity:1;
      transform: translateY(0);
    }

    /* Lightbox */
    .lightbox{
      position:fixed;
      inset:0;
      background: rgba(0,0,0,.65);
      display:none;
      align-items:center;
      justify-content:center;
      padding: 18px;
      z-index: 999;
    }
    .lightbox.active{ display:flex; }
    .lightbox-inner{
      width:min(980px, 100%);
      background: rgba(255,255,255,.10);
      border: 1px solid rgba(255,255,255,.18);
      border-radius: 22px;
      backdrop-filter: blur(14px);
      padding: 14px;
      box-shadow: var(--shadow);
      position:relative;
    }
    .lightbox img{
      width:100%;
      max-height: 74vh;
      object-fit: contain;
      border-radius: 16px;
      background: rgba(0,0,0,.25);
    }
    .x{
      position:absolute;
      right: 12px;
      top: 12px;
      width: 40px;
      height: 40px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.25);
      background: rgba(255,255,255,.12);
      color:#fff;
      font-size: 18px;
      cursor:pointer;
    }

    /* Valentine page */
    .question{
      text-align:center;
      padding: 20px 10px 8px;
    }
    .question h2{
      margin: 0 0 8px;
      font-size: clamp(26px, 3.4vw, 40px);
    }
    .question p{
      margin: 0 0 18px;
      opacity:.95;
    }

    .arena{
      margin-top: 16px;
      position:relative;
      height: 260px;
      border-radius: 22px;
      border: 1px solid rgba(255,255,255,.18);
      background: rgba(0,0,0,.14);
      overflow:hidden;
      display:flex;
      align-items:center;
      justify-content:center;
      flex-direction:column;
      gap: 12px;
    }
    .choice-row{
      display:flex;
      gap: 12px;
      flex-wrap:wrap;
      justify-content:center;
      align-items:center;
    }
    .btn.yes{
      background: #fff;
    }
    .btn.no{
      position:absolute;
      left: 58%;
      top: 55%;
      transform: translate(-50%, -50%);
      background: rgba(255,255,255,.12);
      border: 1px solid rgba(255,255,255,.25);
      color:#fff;
      box-shadow:none;
    }

    .message{
      margin-top: 10px;
      font-weight: 700;
      font-size: 18px;
      min-height: 24px;
    }

    /* Confetti */
    .confetti{
      position:fixed;
      inset:0;
      pointer-events:none;
      overflow:hidden;
      z-index: 9999;
      display:none;
    }
    .confetti.active{ display:block; }
    .confetti span{
      position:absolute;
      top:-10px;
      width: 10px;
      height: 14px;
      opacity: .95;
      animation: confettiFall linear forwards;
      border-radius: 2px;
      filter: drop-shadow(0 8px 10px rgba(0,0,0,.25));
    }
    @keyframes confettiFall{
      to{ transform: translateY(110vh) rotate(720deg); }
    }

    footer{
      padding: 0 18px 18px;
      opacity: .85;
      font-size: 13px;
      display:flex;
      justify-content:space-between;
      flex-wrap:wrap;
      gap:10px;
    }
    .tiny{
      opacity:.9;
    }

    a{ color:#fff; }

    /* ====== CAPTCHA PAGE (dynamic & professional) ====== */
    .captcha-wrap{
      display:grid;
      gap: 14px;
    }
    .captcha-top{
      text-align:center;
      padding: 10px 6px 0;
    }
    .captcha-top h2{
      margin: 0 0 6px;
      font-size: clamp(22px, 3.2vw, 34px);
      letter-spacing:-0.01em;
    }
    .captcha-top p{
      margin: 0;
      opacity: .95;
      line-height:1.5;
    }
    .captcha-panel{
      margin-top: 10px;
      padding: 14px;
      border-radius: 22px;
      border: 1px solid rgba(255,255,255,.18);
      background: rgba(0,0,0,.12);
    }
    .captcha-row{
      display:flex;
      gap: 12px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
    }
    .checkbox{
      display:flex;
      align-items:center;
      gap: 10px;
      padding: 12px 14px;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.22);
      background: rgba(255,255,255,.10);
      cursor:pointer;
      user-select:none;
      font-weight: 800;
    }
    .checkbox input{
      width: 18px;
      height: 18px;
      accent-color: white;
    }
    .captcha-meta{
      display:flex;
      gap: 10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:flex-end;
      opacity:.95;
      font-weight:800;
      font-size: 13px;
    }
    .chip{
      padding: 10px 12px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.18);
      background: rgba(255,255,255,.10);
      white-space:nowrap;
    }
    .challenge{
      display:none;
      margin-top: 12px;
      padding-top: 12px;
      border-top: 1px solid rgba(255,255,255,.14);
    }
    .challenge.active{ display:block; }

    .challenge-head{
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      gap: 10px;
      flex-wrap:wrap;
      margin-bottom: 10px;
    }
    .prompt{
      font-weight: 900;
      font-size: 15px;
    }
    .hint{
      opacity: .9;
      font-size: 13px;
      margin-top: 6px;
      line-height:1.4;
    }

    .captcha-grid{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
    }
    @media (max-width: 650px){
      .captcha-grid{ grid-template-columns: repeat(2, 1fr); }
    }

    .captcha-tile{
      position:relative;
      border-radius: 16px;
      overflow:hidden;
      border: 1px solid rgba(255,255,255,.18);
      background: rgba(0,0,0,0.18);
      aspect-ratio: 1 / 1;
      cursor:pointer;
      transition: transform .12s ease;
    }
    .captcha-tile:hover{ transform: translateY(-2px) scale(1.01); }
    .captcha-tile img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
      user-select:none;
      -webkit-user-drag:none;
      filter: saturate(1.08);
      transform: scale(1.02);
    }
    .captcha-tile.selected{
      outline: 3px solid rgba(255,255,255,.88);
      box-shadow: 0 18px 40px rgba(0,0,0,.25);
    }
    .captcha-tile.selected:after{
      content:"‚úì";
      position:absolute;
      right:10px; top:10px;
      width: 28px; height: 28px;
      border-radius: 10px;
      display:flex;
      align-items:center;
      justify-content:center;
      background: rgba(255,255,255,.88);
      color:#2b0a3d;
      font-weight: 900;
    }

    .captcha-actions{
      display:flex;
      gap: 10px;
      flex-wrap:wrap;
      justify-content:center;
      margin-top: 12px;
    }
    .captcha-msg{
      text-align:center;
      min-height: 22px;
      font-weight: 900;
      margin-top: 8px;
      letter-spacing:-0.01em;
    }
    .captcha-msg.ok{ opacity:.98; }
    .captcha-msg.err{ opacity:.98; }

    .loader{
      display:none;
      align-items:center;
      gap: 10px;
      justify-content:center;
      margin-top: 10px;
      opacity:.92;
      font-weight: 800;
    }
    .loader.active{ display:flex; }
    .spinner{
      width: 18px;
      height: 18px;
      border-radius: 50%;
      border: 2px solid rgba(255,255,255,.35);
      border-top-color: rgba(255,255,255,.95);
      animation: spin .9s linear infinite;
    }
    @keyframes spin{ to{ transform: rotate(360deg); } }
  </style>
</head>

<body>
  <div class="hearts" id="hearts"></div>
  <div class="confetti" id="confetti"></div>

  <div class="wrap">
    <div class="card">
      <header>
        <div class="dots" aria-label="progress">
          <div class="dot" id="dot1"></div>
          <div class="dot" id="dot2"></div>
          <div class="dot" id="dot3"></div>
        </div>

        <div class="nav">
          <span class="status-badge" id="lockBadge" aria-live="polite">
            <span class="status-dot" id="lockDot"></span>
            <span id="lockText">Locked</span>
          </span>

          <button class="pill" data-go="1">Intro</button>
          <button class="pill" data-go="2">Gallery</button>
          <button class="pill" data-go="3">Question</button>
        </div>
      </header>

      <main>
        <!-- PAGE 0: VERIFICATION -->
        <section class="page" id="page0">
          <div class="captcha-wrap">
            <div class="captcha-top">
              <h1 style="margin:0 0 6px;">Verification üíó</h1>
              <p class="subtitle" style="margin:0;">
                Please verify that you are the... <b>Hale Greer</b>.
              </p>
            </div>

            <div class="captcha-panel">
              <div class="captcha-row">
                <label class="checkbox">
                  <input type="checkbox" id="robotCheck">
                  I am not a robot
                </label>

                <div class="captcha-meta">
                  <span class="chip" id="captchaStep">Step 1 of 2</span>
                  <span class="chip" id="captchaSelectCount">Selected 0</span>
                </div>
              </div>

              <div class="loader" id="captchaLoader" aria-hidden="true">
                <span class="spinner"></span>
                <span>Generating challenge‚Ä¶</span>
              </div>

              <div class="challenge" id="challenge">
                <div class="challenge-head">
                  <div>
                    <div class="prompt" id="captchaPrompt">
                      Select all images that match: <span id="captchaTarget">sports game</span>
                    </div>
                    <div class="hint">
                      Click to select/unselect. Then hit <b>Verify</b>.
                    </div>
                  </div>
                  <!-- <button class="btn secondary" id="newChallenge">New prompt</button> -->
                </div>

                <div class="captcha-grid" id="captchaGrid" aria-label="image challenge"></div>

                <div class="captcha-actions">
                  <button class="btn secondary" id="clearSelection">Clear</button>
                  <button class="btn" id="verifyCaptcha">Verify ‚úÖ</button>
                </div>

                <div class="captcha-msg" id="captchaMsg" aria-live="polite"></div>
              </div>
            </div>
          </div>
        </section>

        <!-- PAGE 1: INTRO -->
        <section class="page" id="page1">
          <div class="hero">
            <div>
              <h1 id="title">Hiiii üíñ</h1>
              <p class="subtitle">Here's a website I made for you...</p>

              <div class="type" id="typebox" aria-live="polite"></div>

              <div class="cta-row">
                <button class="btn" id="toGallery">Next ‚Üí</button>
                <button class="btn secondary" id="surprise">Tap Here ‚ú®</button>
              </div>

              <p class="tiny" style="margin-top:12px; opacity:.9;">
                <!-- Tip: Replace the text + images with yours, and this becomes *your* story. -->
              </p>
            </div>

            <div class="big-emoji">
              <span id="emoji">üíò</span>
            </div>
          </div>
        </section>

        <!-- PAGE 2: GALLERY -->
        <section class="page" id="page2">
          <div class="gallery-head">
            <div>
              <h1 style="margin:0 0 6px;">Our Moments üì∏</h1>
              <p class="subtitle" style="margin:0;">We really need to take more pictures!</p>
            </div>
            <button class="btn" id="toQuestion">Next ‚Üí </button>
          </div>

          <div class="gallery-grid" id="gallery">
            <!-- Replace these with your real images in /images -->
            <!-- Added data-tags for the personalized verification grid -->
            <div class="tile"><img src="images\\1.jpg" alt="Us 1" data-message="Always looking fab!" data-tags="none"></div>
            <div class="tile"><img src="images\\2.jpg" alt="Us 2" data-message="I'm glad we got to go to some sports games." data-tags="sports"></div>
            <div class="tile"><img src="images\\3.jpg" alt="Us 3" data-message="Always trying to be me!!" data-tags="none"></div>
            <div class="tile"><img src="images\\4.jpg" alt="Us 4" data-message="Diesel said he likes me more..." data-tags="diesel"></div>
            <div class="tile"><img src="images\\5.jpg" alt="Us 5" data-message="I'm excited to try more wine!" data-tags="wine"></div>
            <div class="tile"><img src="images\\6.jpg" alt="Us 6" data-message="Your first real football experience!" data-tags="football"></div>
            <div class="tile"><img src="images\\7.jpg" alt="Us 7" data-message="We should try more new restraunts!" data-tags="restaurants"></div>
            <div class="tile"><img src="images\\8.jpg" alt="Us 8" data-message="Bring back the digital camera!" data-tags="camera"></div>
          </div>
        </section>

        <!-- PAGE 3: THE QUESTION -->
        <section class="page" id="page3">
          <div class="question">
            <h2>Will you be my Valentine? üíù</h2>
            <p>Choose wisely!</p>

            <div class="arena" id="arena">
              <div class="choice-row">
                <button class="btn yes" id="yesBtn">YES üòç</button>
              </div>

              <button class="btn no" id="noBtn">No üôà</button>

              <div class="message" id="msg"></div>
            </div>

            <div class="cta-row" style="justify-content:center; margin-top:16px;">
              <button class="btn secondary" id="backToGallery">‚Üê Back to Gallery</button>
              <button class="btn" id="restart">Restart ‚ú®</button>
            </div>
          </div>
        </section>
      </main>

      <footer>
        <div>Made with üíó by <span id="by">Kyle Dorito</span></div>
        <div class="tiny">GitHub Pages ready ‚Ä¢ no frameworks</div>
      </footer>
    </div>
  </div>

  <!-- Lightbox -->
  <div class="lightbox" id="lightbox" aria-hidden="true">
    <div class="lightbox-inner">
      <button class="x" id="closeLb" aria-label="Close">‚úï</button>
      <h3 id="lbCaption" style="margin:0 0 10px; text-align:center;"></h3>
      <img id="lbImg" src="" alt="Expanded photo">
    </div>
  </div>

  <script>
    // ====== SIMPLE "PAGES" NAV (with verification gate) ======
    const pages = [
      document.getElementById('page0'),
      document.getElementById('page1'),
      document.getElementById('page2'),
      document.getElementById('page3')
    ];
    const dots = [
      document.getElementById('dot1'),
      document.getElementById('dot2'),
      document.getElementById('dot3')
    ];

    const navPills = document.querySelectorAll('[data-go]');
    const lockBadge = document.getElementById('lockBadge');
    const lockText = document.getElementById('lockText');
    const lockDot = document.getElementById('lockDot');

    let unlocked = false;

    function setNavLocked(isLocked){
      navPills.forEach(btn=>{
        btn.disabled = isLocked;
        btn.setAttribute('aria-disabled', isLocked ? 'true' : 'false');
      });
      lockText.textContent = isLocked ? "Locked" : "Unlocked";
      lockDot.classList.toggle('ok', !isLocked);
    }

    function goPage(n){
      // n: 0..3 where 0 is verification
      if(!unlocked && n !== 0) n = 0;

      for(let i=0;i<=3;i++){
        pages[i].classList.toggle('active', i===n);
      }

      // dots represent pages 1..3 only
      for(let i=0;i<3;i++){
        const pageIndex = i + 1; // 1..3
        dots[i].classList.toggle('active', pageIndex === n);
      }

      burstHearts(10);
      window.scrollTo({top:0, behavior:"smooth"});
    }

    navPills.forEach(btn=>{
      btn.addEventListener('click', ()=>{
        goPage(Number(btn.dataset.go));
      });
    });

    document.getElementById('toGallery').addEventListener('click', ()=> goPage(2));
    document.getElementById('toQuestion').addEventListener('click', ()=> goPage(3));
    document.getElementById('backToGallery').addEventListener('click', ()=> goPage(2));
    document.getElementById('restart').addEventListener('click', ()=> {
      document.getElementById('msg').textContent = "";
      goPage(1);
      typeStart();
    });

    // Start locked on verification page
    setNavLocked(true);
    goPage(0);

    // ====== TYPEWRITER INTRO ======
    const typebox = document.getElementById('typebox');
    const lines = [
      "Hiii üòå",
      "I wanted to do something small but memorable.",
      "So here‚Äôs your website üíò"
    ];
    let typingTimer;

    function typeStart(){
      clearTimeout(typingTimer);
      typebox.textContent = "";
      let lineIndex = 0, charIndex = 0;

      function tick(){
        const current = lines[lineIndex];
        typebox.textContent = current.slice(0, charIndex);

        if(charIndex < current.length){
          charIndex++;
          typingTimer = setTimeout(tick, 22 + Math.random()*25);
        } else {
          // pause then next line
          lineIndex++;
          if(lineIndex < lines.length){
            charIndex = 0;
            typingTimer = setTimeout(()=>{ typebox.textContent += "\n"; tick(); }, 450);
          }
        }
      }
      tick();
    }

    // Surprise button: rotates emoji + mini confetti
    const emoji = document.getElementById('emoji');
    const surprise = document.getElementById('surprise');
    const emojiList = ["üíò","üíù","üíñ","üíï","üòç","ü•∞","üåπ","üçì","‚ú®"];
    surprise.addEventListener('click', ()=>{
      emoji.textContent = emojiList[Math.floor(Math.random()*emojiList.length)];
      burstHearts(18);
      // confettiBlast(80);
    });

    // ====== FLOATING HEARTS BACKGROUND ======
    const hearts = document.getElementById('hearts');

    function spawnHeart(){
      const h = document.createElement('div');
      h.className = 'heart';
      const left = Math.random()*100;
      const size = 10 + Math.random()*20;
      const duration = 6 + Math.random()*6;

      // random pink/purple
      const colors = ["#ffb3c1","#ff4d6d","#ffd6ff","#c77dff","#ff758f","#ffa6c1"];
      const color = colors[Math.floor(Math.random()*colors.length)];

      h.style.left = left + "vw";
      h.style.bottom = "-20px";
      h.style.width = size + "px";
      h.style.height = size + "px";
      h.style.background = color;
      h.style.animationDuration = duration + "s";
      h.style.opacity = (0.5 + Math.random()*0.5).toFixed(2);

      hearts.appendChild(h);
      setTimeout(()=> h.remove(), duration*1000);
    }

    // gentle continuous hearts
    setInterval(spawnHeart, 420);

    function burstHearts(count){
      for(let i=0;i<count;i++){
        setTimeout(spawnHeart, i*40);
      }
    }

    // ====== GALLERY LIGHTBOX ======
    const lightbox = document.getElementById('lightbox');
    const lbImg = document.getElementById('lbImg');
    const lbCaption = document.getElementById('lbCaption');
    document.getElementById('closeLb').addEventListener('click', ()=> lightbox.classList.remove('active'));
    lightbox.addEventListener('click', (e)=> {
      if(e.target === lightbox) lightbox.classList.remove('active');
    });

    document.querySelectorAll('.tile img').forEach(img=>{
      img.addEventListener('click', ()=>{
        lbImg.src = img.src;
        lbImg.alt = img.alt || "Photo";
        lbCaption.textContent = img.dataset.message || "";
        lightbox.classList.add('active');
      });
    });

    // ====== RUNAWAY "NO" BUTTON + YES CONFETTI ======
    const noBtn = document.getElementById('noBtn');
    const yesBtn = document.getElementById('yesBtn');
    const arena = document.getElementById('arena');
    const msg = document.getElementById('msg');

    function moveNoButton(){
      const rect = arena.getBoundingClientRect();
      const pad = 16;

      // button size approx
      const bw = 110, bh = 46;

      const x = pad + Math.random()*(rect.width - bw - pad*2);
      const y = pad + Math.random()*(rect.height - bh - pad*2);

      noBtn.style.left = x + "px";
      noBtn.style.top = y + "px";
      noBtn.style.transform = "translate(0,0)";
    }

    // moves when hovered/touched
    ["mouseenter","touchstart","click"].forEach(evt=>{
      noBtn.addEventListener(evt, (e)=>{
        e.preventDefault();
        moveNoButton();
        msg.textContent = pick([
          "Hehe nope üòÖ",
          "Too slow üòú",
          "Try again ü§≠",
          "Nice try üôà"
        ]);
      }, {passive:false});
    });

    yesBtn.addEventListener('click', ()=>{
      msg.textContent = "YAYYYY!! üíû I love you!!!";
      confettiBlast(180);
      burstHearts(30);
    });

    function pick(arr){ return arr[Math.floor(Math.random()*arr.length)]; }

    // ====== CONFETTI ======
    const confetti = document.getElementById('confetti');

    function confettiBlast(count){
      confetti.innerHTML = "";
      confetti.classList.add('active');

      const colors = ["#ffffff","#ffd6ff","#ffccd5","#c77dff","#ff4d6d","#ffe5ec"];
      for(let i=0;i<count;i++){
        const piece = document.createElement('span');
        const left = Math.random()*100;
        const sizeW = 6 + Math.random()*8;
        const sizeH = 8 + Math.random()*14;
        const duration = 2.8 + Math.random()*2.2;

        piece.style.left = left + "vw";
        piece.style.width = sizeW + "px";
        piece.style.height = sizeH + "px";
        piece.style.background = colors[Math.floor(Math.random()*colors.length)];
        piece.style.animationDuration = duration + "s";
        piece.style.animationDelay = (Math.random()*0.4) + "s";

        confetti.appendChild(piece);
        setTimeout(()=> piece.remove(), (duration+0.6)*1000);
      }

      setTimeout(()=> confetti.classList.remove('active'), 4000);
    }

    // ====== PERSONALIZED CAPTCHA (DYNAMIC GRID FROM YOUR GALLERY) ======
    const robotCheck = document.getElementById('robotCheck');
    const captchaGrid = document.getElementById('captchaGrid');
    const captchaMsg = document.getElementById('captchaMsg');
    const captchaTarget = document.getElementById('captchaTarget');
    const captchaPrompt = document.getElementById('captchaPrompt');
    const newChallenge = document.getElementById('newChallenge');
    const clearSelection = document.getElementById('clearSelection');
    const verifyCaptcha = document.getElementById('verifyCaptcha');
    const challengeEl = document.getElementById('challenge');
    const captchaLoader = document.getElementById('captchaLoader');
    const captchaSelectCount = document.getElementById('captchaSelectCount');
    const captchaStep = document.getElementById('captchaStep');

    // Prompts MUST match tags used in your gallery image data-tags.
    const challenges = [
      { key: "sports", label: "sports game üèüÔ∏è" },
      { key: "diesel", label: "Diesel üê∂" },
      { key: "wine", label: "wine üç∑" },
      { key: "restaurants", label: "new restaurants üçΩÔ∏è" },
      { key: "camera", label: "digital camera vibes üì∑" }
    ];

    let currentChallenge = challenges[0];

    function shuffle(arr){
      const a = arr.slice();
      for(let i=a.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [a[i], a[j]] = [a[j], a[i]];
      }
      return a;
    }

    function splitTags(tagStr){
      return (tagStr || "")
        .toLowerCase()
        .split(/\s+/)
        .filter(Boolean);
    }

    function galleryItems(){
      return Array.from(document.querySelectorAll('#gallery .tile img')).map(img=>{
        return {
          src: img.src,
          alt: img.alt || "Photo",
          tags: splitTags(img.dataset.tags),
          message: img.dataset.message || ""
        };
      });
    }

    function buildCaptchaGrid(){
      captchaGrid.innerHTML = "";
      const items = shuffle(galleryItems());

      items.forEach(item=>{
        const tile = document.createElement('div');
        tile.className = "captcha-tile";
        tile.dataset.tags = item.tags.join(" ");

        const im = document.createElement('img');
        im.src = item.src;
        im.alt = item.alt;

        tile.appendChild(im);
        tile.addEventListener('click', ()=>{
          tile.classList.toggle('selected');
          captchaMsg.textContent = "";
          captchaMsg.className = "captcha-msg";
          updateSelectedCount();
        });

        captchaGrid.appendChild(tile);
      });
    }

    function updateSelectedCount(){
      const selected = captchaGrid.querySelectorAll('.captcha-tile.selected').length;
      captchaSelectCount.textContent = `Selected ${selected}`;
    }

    function setChallenge(ch){
      currentChallenge = ch;
      captchaTarget.textContent = ch.label;
      captchaPrompt.innerHTML = `Select all images that match: <span id="captchaTarget">${ch.label}</span>`;
      captchaMsg.textContent = "";
      captchaMsg.className = "captcha-msg";
      updateSelectedCount();
    }

    function randomChallenge(){
      const next = challenges[Math.floor(Math.random()*challenges.length)];
      setChallenge(next);
    }

    function showLoader(on){
      captchaLoader.classList.toggle('active', !!on);
      captchaLoader.setAttribute('aria-hidden', on ? 'false' : 'true');
    }

    function tileHasTag(tile, key){
      const tags = splitTags(tile.dataset.tags);
      return tags.includes(key);
    }

    function clearCaptchaSelection(){
      captchaGrid.querySelectorAll('.captcha-tile').forEach(t=> t.classList.remove('selected'));
      updateSelectedCount();
      captchaMsg.textContent = "";
      captchaMsg.className = "captcha-msg";
    }

    function expectedCount(){
      const tiles = Array.from(captchaGrid.querySelectorAll('.captcha-tile'));
      return tiles.filter(t => tileHasTag(t, currentChallenge.key)).length;
    }

    function ensureChallengeIsValid(){
      // If the chosen challenge has zero matching tiles, pick a different one.
      for(let i=0;i<8;i++){
        if(expectedCount() > 0) return;
        randomChallenge();
      }
    }

    robotCheck.addEventListener('change', ()=>{
      if(robotCheck.checked){
        captchaStep.textContent = "Step 2 of 2";
        challengeEl.classList.add('active');
        showLoader(true);

        // Slightly "professional" load moment
        setTimeout(()=>{
          buildCaptchaGrid();
          randomChallenge();
          ensureChallengeIsValid();
          clearCaptchaSelection();
          showLoader(false);
          burstHearts(10);
        }, 650);
      } else {
        captchaStep.textContent = "Step 1 of 2";
        challengeEl.classList.remove('active');
        showLoader(false);
        captchaMsg.textContent = "";
        captchaMsg.className = "captcha-msg";
        clearCaptchaSelection();
      }
    });

    newChallenge.addEventListener('click', ()=>{
      randomChallenge();
      ensureChallengeIsValid();
      clearCaptchaSelection();
      burstHearts(8);
    });

    clearSelection.addEventListener('click', ()=>{
      clearCaptchaSelection();
      burstHearts(6);
    });

    verifyCaptcha.addEventListener('click', ()=>{
      const tiles = Array.from(captchaGrid.querySelectorAll('.captcha-tile'));
      const selected = tiles.filter(t => t.classList.contains('selected'));
      const shouldBeSelected = tiles.filter(t => tileHasTag(t, currentChallenge.key));

      // exact match
      const okCount = selected.length === shouldBeSelected.length;
      const allCorrectChosen = shouldBeSelected.every(t => t.classList.contains('selected'));
      const noExtras = selected.every(t => tileHasTag(t, currentChallenge.key));

      if(okCount && allCorrectChosen && noExtras && shouldBeSelected.length > 0){
        captchaMsg.textContent = "Verified üíû";
        captchaMsg.className = "captcha-msg ok";
        confettiBlast(160);
        burstHearts(26);

        unlocked = true;
        setNavLocked(false);

        setTimeout(()=>{
          goPage(1);
          typeStart();
        }, 700);
      } else {
        const need = shouldBeSelected.length;
        captchaMsg.textContent = pick([
          `Not quite üòÖ (You should select ${need} image${need===1 ? "" : "s"}.)`,
          "Close! Select ONLY the matching ones ü§≠",
          "Nope üôà Double-check your selections!"
        ]);
        captchaMsg.className = "captcha-msg err";
        burstHearts(10);
      }
    });

    // ====== Optional: Set your name in footer ======
    document.getElementById('by').textContent = "Kyle";
  </script>
</body>
</html>
